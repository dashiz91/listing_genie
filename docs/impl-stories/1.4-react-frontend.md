# Story 1.4: React Frontend Setup

**Phase:** 1 - Foundation
**Story ID:** 1.4
**Title:** Set Up React Frontend with Vite
**Priority:** Must Have
**Complexity:** Medium
**Status:** Ready for Development

---

## User Story

As a developer, I need a React frontend set up with Vite so that users can interact with the application through a modern, responsive interface.

---

## Acceptance Criteria

- [ ] React app initialized with Vite
- [ ] Tailwind CSS configured for styling
- [ ] Project structure with components/, pages/, api/
- [ ] API client configured to connect to FastAPI backend
- [ ] Basic App component with routing structure
- [ ] Health check integration (test backend connection)
- [ ] Test: App loads and displays health status

---

## Project Structure (CREATE NEW)

```
listing_genie/
├── frontend/
│   ├── src/
│   │   ├── main.tsx              # Entry point
│   │   ├── App.tsx               # Main app component
│   │   ├── vite-env.d.ts
│   │   │
│   │   ├── api/
│   │   │   ├── client.ts         # Axios API client
│   │   │   └── types.ts          # TypeScript types
│   │   │
│   │   ├── components/
│   │   │   └── Layout.tsx        # Basic layout component
│   │   │
│   │   ├── pages/
│   │   │   └── HomePage.tsx      # Landing page placeholder
│   │   │
│   │   └── styles/
│   │       └── index.css         # Tailwind imports
│   │
│   ├── public/
│   ├── index.html
│   ├── package.json
│   ├── tsconfig.json
│   ├── vite.config.ts
│   ├── tailwind.config.js
│   └── postcss.config.js
│
└── app/
    └── (existing backend)
```

---

## Code to Implement

### frontend/package.json

```json
{
  "name": "listing-genie-frontend",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint src --ext ts,tsx"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "axios": "^1.6.0",
    "react-router-dom": "^6.20.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "@vitejs/plugin-react": "^4.2.0",
    "typescript": "^5.2.0",
    "vite": "^5.0.0",
    "autoprefixer": "^10.4.0",
    "postcss": "^8.4.0",
    "tailwindcss": "^3.3.0",
    "eslint": "^8.55.0",
    "@typescript-eslint/eslint-plugin": "^6.14.0",
    "@typescript-eslint/parser": "^6.14.0"
  }
}
```

### frontend/vite.config.ts

```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      },
      '/health': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      }
    }
  }
})
```

### frontend/tailwind.config.js

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#f0f9ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8',
        }
      }
    },
  },
  plugins: [],
}
```

### frontend/postcss.config.js

```javascript
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
```

### frontend/tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

### frontend/src/styles/index.css

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}
```

### frontend/src/api/types.ts

```typescript
export interface HealthResponse {
  status: string;
  service: string;
  version: string;
  dependencies: {
    database: string;
    storage: string;
    gemini: string;
  };
}

export interface ProductInfo {
  title: string;
  features: [string, string, string];
  targetAudience: string;
}

export interface GenerationSession {
  id: string;
  status: 'pending' | 'processing' | 'complete' | 'partial' | 'failed';
  created_at: string;
  completed_at?: string;
}
```

### frontend/src/api/client.ts

```typescript
import axios, { AxiosInstance } from 'axios';
import type { HealthResponse } from './types';

const API_BASE = '/api';

class ApiClient {
  private client: AxiosInstance;

  constructor() {
    this.client = axios.create({
      baseURL: API_BASE,
      timeout: 60000, // 60 second timeout
      headers: {
        'Content-Type': 'application/json',
      }
    });

    // Response interceptor for error handling
    this.client.interceptors.response.use(
      (response) => response,
      (error) => {
        if (error.response?.status === 500) {
          console.error('Server error:', error.response.data);
        }
        return Promise.reject(error);
      }
    );
  }

  // Health check
  async health(): Promise<HealthResponse> {
    const response = await this.client.get<HealthResponse>('/health');
    return response.data;
  }

  // Additional methods will be added in later stories
  // - uploadImage()
  // - startGeneration()
  // - getGenerationStatus()
  // - downloadImage()
}

export const apiClient = new ApiClient();
```

### frontend/src/components/Layout.tsx

```typescript
import React from 'react';

interface LayoutProps {
  children: React.ReactNode;
}

export const Layout: React.FC<LayoutProps> = ({ children }) => {
  return (
    <div className="min-h-screen bg-gray-50">
      <header className="bg-white shadow-sm">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <h1 className="text-2xl font-bold text-primary-700">
            Listing Genie
          </h1>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {children}
      </main>

      <footer className="bg-white border-t mt-12">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <p className="text-center text-gray-500 text-sm">
            © 2025 Listing Genie - AI-Powered Amazon Listing Images
          </p>
        </div>
      </footer>
    </div>
  );
};
```

### frontend/src/pages/HomePage.tsx

```typescript
import React, { useEffect, useState } from 'react';
import { apiClient } from '../api/client';
import type { HealthResponse } from '../api/types';

export const HomePage: React.FC = () => {
  const [health, setHealth] = useState<HealthResponse | null>(null);
  const [error, setError] = useState<string | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const checkHealth = async () => {
      try {
        const data = await apiClient.health();
        setHealth(data);
        setError(null);
      } catch (err) {
        setError('Failed to connect to backend');
        console.error(err);
      } finally {
        setLoading(false);
      }
    };

    checkHealth();
  }, []);

  return (
    <div className="text-center">
      <h2 className="text-4xl font-bold text-gray-900 mb-4">
        Transform Your Product Photo Into 5 Professional Listing Images
      </h2>

      <p className="text-xl text-gray-600 mb-8">
        AI-powered Amazon listing image generation in minutes
      </p>

      {/* Backend Health Status */}
      <div className="max-w-md mx-auto bg-white rounded-lg shadow-md p-6">
        <h3 className="text-lg font-semibold mb-4">System Status</h3>

        {loading && (
          <p className="text-gray-600">Checking backend connection...</p>
        )}

        {error && (
          <div className="bg-red-50 border border-red-200 rounded p-4">
            <p className="text-red-600">{error}</p>
          </div>
        )}

        {health && (
          <div className="space-y-2">
            <div className="flex justify-between items-center">
              <span className="text-gray-700">API Status:</span>
              <span className="text-green-600 font-semibold">{health.status}</span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-gray-700">Database:</span>
              <span className={health.dependencies.database === 'connected' ? 'text-green-600' : 'text-red-600'}>
                {health.dependencies.database}
              </span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-gray-700">Storage:</span>
              <span className={health.dependencies.storage === 'accessible' ? 'text-green-600' : 'text-red-600'}>
                {health.dependencies.storage}
              </span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-gray-700">Version:</span>
              <span className="text-gray-600">{health.version}</span>
            </div>
          </div>
        )}
      </div>

      {/* Placeholder for future steps */}
      <div className="mt-12">
        <button
          disabled
          className="px-6 py-3 bg-gray-300 text-gray-500 rounded-lg font-semibold cursor-not-allowed"
        >
          Start Generating (Coming Soon)
        </button>
        <p className="text-sm text-gray-500 mt-2">
          Upload and generation features will be added in future stories
        </p>
      </div>
    </div>
  );
};
```

### frontend/src/App.tsx

```typescript
import React from 'react';
import { Layout } from './components/Layout';
import { HomePage } from './pages/HomePage';

function App() {
  return (
    <Layout>
      <HomePage />
    </Layout>
  );
}

export default App;
```

### frontend/src/main.tsx

```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './styles/index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

### frontend/index.html

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Listing Genie - AI Amazon Listing Images</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

---

## Test Gate (Must Pass Before Story 1.5)

```bash
# Install dependencies
cd frontend
npm install

# Start backend (in separate terminal)
cd ..
uvicorn app.main:app --reload

# Start frontend dev server
cd frontend
npm run dev

# Open browser to http://localhost:5173
# Expected: App loads, shows "System Status" with green checkmarks

# Test backend connection
# Expected in browser:
# - API Status: healthy
# - Database: connected (green)
# - Storage: accessible (green)
# - Version: 1.0.0

# Test build
npm run build
# Expected: dist/ folder created with compiled assets

# Test production preview
npm run preview
# Expected: App loads at http://localhost:4173
```

---

## Dependencies

- **Depends On:** Story 1.1 (FastAPI Backend), Story 1.2 (Database), Story 1.3 (Storage)
- **Blocks:** Story 1.5, 2.1, Epic 3 (UI features)

---

## Definition of Done

- [ ] React app created with Vite
- [ ] Tailwind CSS configured and working
- [ ] API client can call backend /api/health
- [ ] HomePage displays backend health status
- [ ] All backend dependencies show correct status
- [ ] npm run dev starts successfully
- [ ] npm run build completes without errors
- [ ] App is responsive (mobile, tablet, desktop)

---

## Notes for Developer

1. **Vite Proxy:** Configured to proxy /api requests to localhost:8000
2. **TypeScript:** Using strict mode for type safety
3. **Tailwind:** Custom primary color palette configured
4. **API Client:** Axios with interceptors for error handling
5. **Health Check:** Demonstrates backend integration immediately
6. **Future-Ready:** Structure prepared for upload, form, gallery components
7. **No Router Yet:** Using simple component structure, router will be added in Epic 3

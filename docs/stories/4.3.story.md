# Story 4.3: Generate Images Matching Keyword Intent

**Epic:** Epic 4 - Keyword Intent System
**Story ID:** 4.3
**Title:** Generate Images Matching Keyword Intent
**Priority:** Must Have
**Complexity:** Large
**Status:** Draft

---

## User Story

As a user, I want each image to visually prove the intent behind my keywords so that shoppers see exactly what they searched for.

---

## Acceptance Criteria

- [ ] Prompts dynamically incorporate keyword intent
- [ ] Durability intent -> show rugged textures, stress tests, comparison to competitors
- [ ] Use case intent -> show product in that exact context (camping scene, office desk, etc.)
- [ ] Style intent -> match visual aesthetic to style keywords
- [ ] Problem/solution intent -> show before/after or relief/result
- [ ] Each image type prioritizes different intent groups:
  - Main Image: Quality/Premium intents
  - Lifestyle: Use Case intents
  - Infographics: Problem/Solution intents
  - Comparison: Comparison intents
- [ ] Keywords visible in generation metadata for reference

---

## Technical Notes

### Core Concept: "Close the Loop"
From Chris Rawlings' PPC Data Loop strategy:
> "Close the loop" between buyer search intent and visual assets. If keywords don't match what images show, shoppers won't convert.

### Image-to-Intent Mapping
From `docs/creative-blueprint.md` Section 5:

| Image Type | Primary Intent Focus | Secondary Intent |
|------------|---------------------|------------------|
| Main Image | Quality/Premium | Style/Aesthetic |
| Infographic 1 | Problem/Solution | Durability |
| Infographic 2 | Problem/Solution | Use Case |
| Lifestyle | Use Case | Style/Aesthetic |
| Comparison | Comparison | Durability/Quality |

### Intent Modifiers Reference
See `docs/architecture.md` Section 5.4 for intent_modifiers.py:

```python
INTENT_VISUAL_PROOF = {
    'durability': [
        "Show rugged, premium materials and construction quality",
        "Emphasize durability through visual texture and build quality",
    ],
    'use_case': [
        "Show product in the exact context implied by search terms",
        "Environment should match intended usage",
    ],
    'problem_solution': [
        "Visualize the solved state / positive outcome",
        "Show relief, satisfaction, or resolution",
    ],
    # ... etc
}
```

### Prompt Injection Pattern
```
[KEYWORD INTENT INJECTION]
Top converting keywords: {keyword_list}
Primary intent detected: {intent_category}
Visual proof required: {proof_description}

Generate an image that VISUALLY PROVES the intent behind these search terms.
```

---

## Dependencies

- **Depends On:** Story 2.1b (Prompt System), Story 4.2 (Classification)
- **Required By:** Stories 2.2-2.5 (all image generation)

---

## Definition of Done

- [ ] Intent modifiers integrated into PromptEngine
- [ ] Each image type uses appropriate intent priorities
- [ ] Prompts include keyword intent injection
- [ ] Generated images reflect detected intents
- [ ] Keywords stored in metadata for reference
- [ ] Intent alignment visible in prompt construction
- [ ] Test: durability keywords -> rugged/premium visuals
- [ ] Test: use case keywords -> contextual scenes

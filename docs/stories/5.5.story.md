# Story 5.5: Configure Single Container Deployment

**Epic:** Epic 5 - Core Infrastructure
**Story ID:** 5.5
**Title:** Configure Single Container Deployment
**Priority:** Must Have
**Complexity:** Medium
**Status:** Draft

---

## User Story

As a developer, I need deployment configuration so that the application can be deployed to production.

---

## Acceptance Criteria

- [ ] Dockerfile for single container deployment
- [ ] Frontend build integrated with backend serving
- [ ] Environment variable handling for production
- [ ] Health check endpoint for container orchestration
- [ ] Logging configuration for production
- [ ] Railway/Render deployment configuration
- [ ] CI/CD pipeline basics (optional for MVP)

---

## Technical Notes

### Dockerfile Reference
See `docs/architecture.md` Section 7.1 for complete Dockerfile.

### Multi-Stage Build
```dockerfile
# Stage 1: Build Frontend
FROM node:20-alpine AS frontend-builder
# ... build React app

# Stage 2: Python Application
FROM python:3.11-slim AS production
# ... install dependencies, copy app and frontend build
```

### Key Configurations

**Health Check:**
```dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:8000/health || exit 1
```

**Railway Configuration (railway.toml):**
```toml
[build]
builder = "DOCKERFILE"

[deploy]
healthcheckPath = "/health"
healthcheckTimeout = 30
```

### Environment Variables for Production
See `docs/architecture.md` Section 7.2 for complete list:
- APP_ENV=production
- DEBUG=false
- GEMINI_API_KEY (secret)
- DATABASE_URL
- STORAGE_TYPE

---

## Dependencies

- **Depends On:** Stories 5.1, 5.2, 5.3, 5.4 (all infrastructure)
- **Required By:** None (final infrastructure story)

---

## Definition of Done

- [ ] Dockerfile builds successfully
- [ ] Container runs and serves application
- [ ] Frontend accessible via backend
- [ ] Health check returns 200
- [ ] Environment variables load correctly
- [ ] Logs output in JSON format
- [ ] Container can be deployed to Railway/Render
